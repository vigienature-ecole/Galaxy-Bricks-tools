<tool id="columns-simple-operation" name="Opération sur des colonnes">
    <requirements>
        <requirement type="package" version="1.12.2">r-data.table</requirement>
    </requirements>
    <command detect_errors="exit_code"><![CDATA[
        Rscript '$__tool_directory__/columns-simple-operation.R' '$input' '$inputFormula' '$inputName' '$add' '$output' ]]>
    </command>
    <inputs>
        <param format="tabular,csv" name="input" type="data" label="Données d'entrée" />
        <param name="inputFormula" type="text" value="c1 + c2" label="Formule" help="Pour selectionner une colonne taper c et le numéro de la colonne (e.g. c2 pour la deuxième colonne)" />
        <param name="inputName" type="text" value="" label="Nom de la colonne de résultat" />
        <param truevalue="TRUE" falsevalue="FALSE" label="Ajouter la colonne au jeu de données initial" help="Si vous selectionnez non, vous obtiendrez seulement la colonne calculer lors de cette étape en résultat" name="add" type="boolean" />
        <param format="tabular,csv,txt" name="input" type="data" label="Input file" />
        <param name="inputFormula" type="text" value="c1 + c2" label="Formula" help="Identify columns with a c and the number of the column (e.g. c2 for the second column)" />
        <param name="inputName" type="text" value="" label="Name of the resulting column" />
        <param truevalue="TRUE" falsevalue="FALSE" label="Add column to original dataset" name="add" type="boolean" />
    </inputs>
    <outputs>
        <data format="tabular" name="output" from_work_dir="result.tabular"/>
    </outputs>
    <tests>
        <test> <!--FAILED-->
            <param name="input" value="irisPlus.tabular"/>
            <param name="inputFormula" value="c1 / c2"/>
            <param name="inputName" value="Sepal.Ratio"/>
            <param name="add" value="TRUE"/>
            <output name="output" value="out-simple-operation.tabular"/>
        </test>
    </tests>
    <help><![CDATA[

.. class:: infomark

This tool performs operations on columns:
 * it is possible to combine multiple columns (e.g. c1 * c2)
 * it is possible to transform one column using constants (e.g. c1 / 2)
 * it is possible to combine the operations described above within a formula (e.g. log(c1) + c2)

1. you can use elementary operations

"+" addition
"-" subtraction
"*" multiplication
"/" division

**Example**

input dataset ::

 "a"  "b"
  1    0
  2    5
  5    6
 10    2

Formula :

c1 + c2

Result ::

 "result"
    1
    7
   11
   12

   2. You can transform your data

   "log(c2)", "exp(c2)", "log10(c2)", "exp(c2)", "sqrt(c2)", "sin(c2)", "cos(c2)", "tan(c2)", "asin(c2)", "acos(c2)"

   **Example**

   input dataset ::

    "a"  "b"
    1    0
    2    5
    5    6
   10    2

  Formula :

  "exp(c2)"
  Result ::

 "result"
    1
    148.41
    403.42
    7.38

3. You can summarise your data
"sum(c2)"
"mean(c2)"
"sd(c2)"
"var(c2)"

**Example**

input dataset ::

 "a"  "b"
  1    0
  2    5
  5    6
 10    2

Formula :

c1 + c2
Add column to original dataset = Yes

Result ::

"a"  "b" "result"
 1    0  3.25
 2    5  3.25
 5    6  3.25
10    2  3.25




    ]]></help>
</tool>
